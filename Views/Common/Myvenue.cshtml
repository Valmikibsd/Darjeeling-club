@model ClubApp.Models.Mybills
@{
    ViewData["Title"] = "ManagingCommittee";
    Layout = null;
}

<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, shrink-to-fit=no, viewport-fit=cover">

    <link rel="apple-touch-icon" href="/img/f7-icon-square.html">
    <link rel="icon" href="/img/f7-icon.html">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/vendor/bootstrap-4.1.3/css/bootstrap.min.css">

    <!-- Material design icons CSS -->
    <link rel="stylesheet" href="/vendor/materializeicon/material-icons.css">

    <!-- swiper carousel CSS -->
    <link rel="stylesheet" href="/vendor/swiper/css/swiper.min.css">

    <!-- app CSS -->
    <link id="theme" rel="stylesheet" href="/css/style.css" type="text/css">


    <title>Membership Number</title>
    <style type="text/css">
        .jqstooltip {
            position: absolute;
            left: 0px;
            top: 0px;
            visibility: hidden;
            background: rgb(0, 0, 0) transparent;
            background-color: rgba(0,0,0,0.6);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);
            -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";
            color: white;
            font: 10px arial, san serif;
            text-align: left;
            white-space: nowrap;
            padding: 5px;
            border: 1px solid white;
            z-index: 10000;
        }

        .dis p {
            display: table;
        }
        .dis .media-body {
    display: inline-block;
}

        .jqsfield {
            color: white;
            font: 10px arial, san serif;
            text-align: left;
        }
    </style>

     <script src="https://psa.atomtech.in/staticdata/ots/js/atomcheckout.js" type="text/javascript"></script>
    <script type="text/javascript">
        function openPay() {

            // alert('openPay called');
            var rb = document.getElementById('txttok').value;
            var emailid = document.getElementById('emailid').value;
            var mobileno = document.getElementById('mobileno').value;
            //alert("mesage:"+rb);
            const options = {
                "atomTokenId": rb,
                "merchId": "438556",
                "custEmail": emailid,
                "custMobile": mobileno,
                "returnUrl": "https://app.holidayclub.in/Common/BookingResponse"
            }
            let atom = new AtomPaynetz(options, 'uat');
        }

       
    </script>
</head>


<body class="color-theme-blue" >
    <div class="wrapper">
        <!-- page main start -->
        <div class="page">
            <div class="page-content h-100">
                <div class="page-content">
                    <div class="content-sticky-footer pt-2">

                        <div class="col-12 mb-4">
                            <div class="row">
                                <div class="col-12"><a href="/Common/login" class="menu-left-close inner_back block-title"><i class="material-icons">keyboard_arrow_left</i></a><h2 class="block-title inner_title title_top">My Venue booking</h2></div>
                            </div>
                        </div>
                        <div class="row mx-0 ">
                            <div class="col">
                                <div id="accordion">
                                    <div class="card mb-1 border-0 rounded-0">
                                        <!-- profile-data -->
                                        <div class="Affiliated">
                                            <div class="card-bodys">
                                                <div class="dis">
                                                    <div class="col-12">
                                                        @if (Model.MUVENUEBOOKING.Count > 0)
                                                        {
                                                            @foreach (var sub in Model.MUVENUEBOOKING)
                                                            {
                                                                <div class="diss" style="background-color:silver">
                                                                    <div class="card">
                                                                        <div class="card-bodya">

                                                                            <div class="media-body" style="text-align:center">
                                                                                <P><b>Booking No-</b>@sub.partyno</P>
                                                                                <P><b> Venue Name- </b>@sub.VenueName</P>
                                                                                <p><b> Slot Name- </b>@sub.name</p>
                                                                                <p><b> Rental Amount-</b>@sub.RENTAL</p>
                                                                                <p><b>Venue Date-</b>@sub.venue_date</p>
                                                                                <p><b>Booking Date-</b>@sub.curr_date</p>
                                                                                <p><b>Amount - </b>@sub.totalvenueamt</p>
                                                                                <p><b>Status - </b>@sub.STATUS</p>
                                                                                @if (Convert.ToDouble(sub.refudamt) > 0)
                                                                                {
                                                                                    <p><b>Refund Amount - </b>@sub.refudamt</p>
                                                                                }
                                                                                <br>
                                                                                @if (Convert.ToDouble(sub.calcelamount) > 0 && @sub.STATUS != "Cancel")
                                                                                {
                                                                                    <a href="#" class="opendalog" data-toggle="modal" data-target="#colorscheme" data-name="@sub.calcelamount" data-id="@sub.partyno" data-ten="@sub.tentivebooking">
                                                                                        Cancel Booking
                                                                                    </a>
                                                                                    
                                                                                   
                                                                                    if (sub.tentivebooking ==1)
                                                                                    {
                                                                                        <a href="#"   id="paynow" data-target="#colorscheme" data-name="@sub.calcelamount" data-id="@sub.partyno">
                                                                                            <span>| </span>   Pay now
                                                                                    </a>
                                                                                       @*<button class="btn btn-primary" id="btnsubmit" name="submit" type="submit" onclick="IUContactUs()">Pay Now</button>*@
                                                                                    }
                                                                                }
                                                                            </div>




                                                                        </div>

                                                                    </div>
                                                                </div>
                                                            }
                                                        }
                                                        else
                                                        {
                                                         
                                                           <img src="\img\picture1.png"  style="height:250PX; width:300PX" />

                                                           
                                                        }


                                                    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                          
                            </div>
                        </div>

                      
                    </div>
                </div>

                <br>

            </div>

        </div>
        <!-- page main ends -->

    </div>
    <div class="modal fade bottom main_venue" id="colorscheme" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content ">
                <div class="modal-body">
                    <div class="text-center theme-color">
                        <p class="text-uppercase font-weight-bold text-dark text-center" id="vname" style="color:red">Your Refund Amount  </p>

                        if You want cancel this booking, As per club cancellation and refund reuls
                        <p>Your Refund Amount</p> <div id="AMT"></div>
                        <br />

                        <button><a href="#" id="book">Cancel</a></button>

                    </div>

                </div>
            </div>
        </div>
    </div>
    <input type="hidden"  value="" id="PATRYNO" />
    <input type="hidden" id="txttok" name="txttok" value="" />
    <input type="hidden" id="emailid" name="emailid" value="@ViewBag.EMAIL" />
    <input type="hidden" id="mobileno" name="mobileno" value="@ViewBag.MOBILE" />



    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/vendor/bootstrap-4.1.3/js/bootstrap.min.js"></script>

    <!-- Cookie jquery file -->
    <script src="/vendor/cookie/jquery.cookie.js"></script>

    <!-- sparklines chart jquery file -->
    <script src="/vendor/sparklines/jquery.sparkline.min.js"></script>

    <!-- Circular progress gauge jquery file -->
    <script src="/vendor/circle-progress/circle-progress.min.js"></script>

    <!-- Swiper carousel jquery file -->
    <script src="/vendor/swiper/js/swiper.min.js"></script>

    <!-- Application main common jquery file -->
    <script src="/js/main.js"></script>

    <!-- page specific script -->



    <script type="text/javascript">

        $('.opendalog').click(function () {

            var amount = $(this).data('name');
            var prtyno = $(this).data('id');
            var tent = $(this).data('ten');

            if(tent==1)
            {
            $("#AMT").html(0)
            }
            else
            {
                $("#AMT").html(amount)

            }

            $("#PATRYNO").val(prtyno);
            
            

        }
        )


        $('#book').click(function () {

            var AMT = $("#AMT").html();
            var patryno=  $("#PATRYNO").val();
          
            $.ajax({
                url: "/Common/INSERTCAL",
                data: { PATRYNO: patryno, AMOUNT: AMT },
                type: "POST",
                // contentType: "application/text;charset=utf-8",
                // dataType: "json",
                success: function (data) {

                    if (data == "Successfull") {


                        window.location.href = "/Common/Successcancel"
                    }

                },

            });

        });

        $(".modal").on('hide.bs.modal', function () {
            alert('The modal is about to be hidden.');
        });


        $('#paynow').click(function () {


            var amount = $(this).data('name');
            var prtyno = $(this).data('id');

            $.ajax({
                url: "/Common/paynow",
                data: { PATRYNO: prtyno, AMOUNT: amount },
                type: "POST",
                dataType: "JSON",
                // contentType: "application/text;charset=utf-8",
                // dataType: "json",
                success: function (result) {

                        if (result.message == "ok") {

                            $("#txttok").val(result.datas)

                            $('.loader_cont').hide();

                            openPay();

                        }
                        else {
                            $("#txttok").val("");
                            $('.loader_cont').hide();

                        }
                    

                },

            });

        });


        // Get the container element
        var btnContainer = document.getElementById("myDIV");

        // Get all buttons with class="btn" inside the container
        var btns = btnContainer.getElementsByClassName("btn");

        // Loop through the buttons and add the active class to the current/clicked button
        for (var i = 0; i < btns.length; i++) {
            btns[i].addEventListener("click", function () {
                var current = document.getElementsByClassName("active");
                current[0].className = current[0].className.replace(" active", "");
                this.className += " active";
            });
        }
    </script>
</body>
</html>

